<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>C Code Runner - CodeSphare</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="p-4">
  <h2 class="mb-3">🔧 CodeSphare: Code Runner</h2>

  <select id="language" class="form-select mb-3">
    <option value="50">C (GCC 9.2.0)</option>
    <option value="54">C++ (G++ 9.2.0)</option>
    <option value="71">Python 3 (3.8.1)</option>
  </select>

  <label><strong>🧠 Write your code:</strong></label>
  <textarea id="code" class="form-control mb-3" rows="10" placeholder="Write your code here..."></textarea>

  <label><strong>📥 Input / Output Area (Editable):</strong></label>
  <pre id="output" class="bg-light p-3 border rounded" contenteditable="true">Type input here...</pre>

  <button onclick="runCode()" class="btn btn-primary mt-3">▶️ Run Code</button>

  <script>
    function runCode() {
      const code = document.getElementById("code").value;
      const languageId = document.getElementById("language").value;
      const userInput = document.getElementById("output").innerText;

      const payload = {
        source_code: code,
        language_id: parseInt(languageId),
        stdin: userInput
      };

      const outputBox = document.getElementById("output");
      outputBox.innerText = "⏳ Running...";
      outputBox.classList.remove("text-danger", "text-success");

      fetch("https://judge0-ce.p.rapidapi.com/submissions?base64_encoded=false&wait=true", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "x-rapidapi-host": "judge0-ce.p.rapidapi.com",
          "x-rapidapi-key": "1d74aa8374msh48776d5d6cdcb53p13ed0bjsn8b6de8a7d547" // Replace this
        },
        body: JSON.stringify(payload),
      })
      .then(response => response.json())
      .then(result => {
        let output = "";
        if (result.compile_output) {
          output = "🔧 Compile Error:\n" + result.compile_output;
          outputBox.classList.add("text-danger");
        } else if (result.stderr) {
          output = "💥 Runtime Error:\n" + result.stderr;
          outputBox.classList.add("text-danger");
        } else if (result.stdout) {
          output = "✅ Output:\n" + result.stdout;
          outputBox.classList.add("text-success");
        } else {
          output = "⚠️ No output received.";
        }

        outputBox.innerText = output;
      })
      .catch(err => {
        outputBox.innerText = "❌ Error: " + err;
        outputBox.classList.add("text-danger");
      });
    }
  </script>
</body>
</html>
